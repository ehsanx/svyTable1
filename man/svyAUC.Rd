% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/svyAUC.R
\name{svyAUC}
\alias{svyAUC}
\title{Calculate a Design-Correct AUC for a Survey Model}
\usage{
svyAUC(fit, design)
}
\arguments{
\item{fit}{A fitted model object of class `svyglm`.}

\item{design}{A replicate-weights survey design object, typically created with `as.svrepdesign`.}
}
\value{
A `data.frame` containing the AUC point estimate, its standard error (SE),
and the lower and upper bounds of the 95% confidence interval.
}
\description{
This function calculates the Area Under the Curve (AUC) and its design-correct
standard error and 95% confidence interval for a survey logistic regression
model. It correctly accounts for strata and clusters by using a
replicate-weights survey design object.
}
\examples{
\dontrun{
# Ensure required packages are loaded
if (requireNamespace("survey", quietly = TRUE) &&
    requireNamespace("NHANES", quietly = TRUE) &&
    requireNamespace("dplyr", quietly = TRUE)) {

  # 1. Prepare Data
  data(NHANESraw, package = "NHANES")
  nhanes_data <- NHANESraw \%>\%
    dplyr::filter(Age >= 20) \%>\%
    dplyr::mutate(ObeseStatus = factor(ifelse(BMI >= 30, "Obese", "Not Obese"),
                                       levels = c("Not Obese", "Obese"))) \%>\%
    dplyr::filter(complete.cases(ObeseStatus, Age, Gender, Race1,
                                 WTMEC2YR, SDMVPSU, SDMVSTRA))

  # 2. Create a replicate design object
  std_design <- survey::svydesign(
    ids = ~SDMVPSU,
    strata = ~SDMVSTRA,
    weights = ~WTMEC2YR,
    nest = TRUE,
    data = nhanes_data
  )
  rep_design <- survey::as.svrepdesign(std_design)

  # 3. Fit a survey logistic regression model using the replicate design
  fit_obesity_rep <- survey::svyglm(
    ObeseStatus ~ Age + Gender + Race1,
    design = rep_design,
    family = quasibinomial()
  )

  # 4. Calculate the design-correct AUC
  auc_results <- svyAUC(fit_obesity_rep, rep_design)
  print(auc_results)
}
}
}
